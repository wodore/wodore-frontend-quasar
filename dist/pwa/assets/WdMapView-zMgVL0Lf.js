import{j as c,c as A,u as Y,d as Z,r as x,b1 as U,g as O,k as H,aO as D,b2 as G,q as _,Q as F,t as W,af as N,P as J,i as P,h as j,v as X,y as V,C as M,E as z,F as k,H as w,a9 as K,G as ee,_ as R,z as te,A as oe,D as ae,L as se,ai as le,p as ne,b3 as ie,b4 as re,b5 as ce,M as ue,R as pe,S as de,B as Q,I as d,b6 as fe}from"./index-DXC2eJBE.js";import{L as me,_ as ge,j as he,F as ve,c as ye,C as be}from"./vue-maplibre-gl.es-A3sulMbW.js";import"./_commonjsHelpers-C4iS2aBk.js";const _e=["top","right","bottom","left"],I={type:{type:String,default:"a"},outline:Boolean,push:Boolean,flat:Boolean,unelevated:Boolean,color:String,textColor:String,glossy:Boolean,square:Boolean,padding:String,label:{type:[String,Number],default:""},labelPosition:{type:String,default:"right",validator:e=>_e.includes(e)},externalLabel:Boolean,hideLabel:{type:Boolean},labelClass:[Array,String,Object],labelStyle:[Array,String,Object],disable:Boolean,tabindex:[Number,String]};function we(e,o){return{formClass:c(()=>`q-fab--form-${e.square===!0?"square":"rounded"}`),stacked:c(()=>e.externalLabel===!1&&["top","bottom"].includes(e.labelPosition)),labelProps:c(()=>{if(e.externalLabel===!0){const a=e.hideLabel===null?o.value===!1:e.hideLabel;return{action:"push",data:{class:[e.labelClass,`q-fab__label q-tooltip--style q-fab__label--external q-fab__label--external-${e.labelPosition}`+(a===!0?" q-fab__label--external-hidden":"")],style:e.labelStyle}}}return{action:["left","top"].includes(e.labelPosition)?"unshift":"push",data:{class:[e.labelClass,`q-fab__label q-fab__label--internal q-fab__label--internal-${e.labelPosition}`+(e.hideLabel===!0?" q-fab__label--internal-hidden":"")],style:e.labelStyle}}})}}const xe=["up","right","down","left"],Se=["left","center","right"],ke=A({name:"QFab",props:{...I,...Y,icon:String,activeIcon:String,hideIcon:Boolean,hideLabel:{...I.hideLabel,default:null},direction:{type:String,default:"right",validator:e=>xe.includes(e)},persistent:Boolean,verticalActionsAlign:{type:String,default:"center",validator:e=>Se.includes(e)}},emits:Z,setup(e,{slots:o}){const a=x(null),s=x(e.modelValue===!0),r=U(),{proxy:{$q:i}}=O(),{formClass:f,labelProps:l}=we(e,s),u=c(()=>e.persistent!==!0),{hide:p,toggle:b}=H({showing:s,hideOnRouteChange:u}),n=c(()=>({opened:s.value})),h=c(()=>`q-fab z-fab row inline justify-center q-fab--align-${e.verticalActionsAlign} ${f.value}`+(s.value===!0?" q-fab--opened":" q-fab--closed")),v=c(()=>`q-fab__actions flex no-wrap inline q-fab__actions--${e.direction} q-fab__actions--${s.value===!0?"opened":"closed"}`),$=c(()=>{const t={id:r.value,role:"menu"};return s.value!==!0&&(t["aria-hidden"]="true"),t}),g=c(()=>`q-fab__icon-holder  q-fab__icon-holder--${s.value===!0?"opened":"closed"}`);function C(t,y){const m=o[t],S=`q-fab__${t} absolute-full`;return m===void 0?_(J,{class:S,name:e[y]||i.iconSet.fab[y]}):_("div",{class:S},m(n.value))}function L(){const t=[];return e.hideIcon!==!0&&t.push(_("div",{class:g.value},[C("icon","icon"),C("active-icon","activeIcon")])),(e.label!==""||o.label!==void 0)&&t[l.value.action](_("div",l.value.data,o.label!==void 0?o.label(n.value):[e.label])),N(o.tooltip,t)}return D(G,{showing:s,onChildClick(t){p(t),a.value!==null&&a.value.$el.focus()}}),()=>_("div",{class:h.value},[_(F,{ref:a,class:f.value,...e,noWrap:!0,stack:e.stacked,align:void 0,icon:void 0,label:void 0,noCaps:!0,fab:!0,"aria-expanded":s.value===!0?"true":"false","aria-haspopup":"true","aria-controls":r.value,onClick:b},L),_("div",{class:v.value,...$.value},W(o.default))])}}),$e={position:{type:String,default:"bottom-right",validator:e=>["top-right","top-left","bottom-right","bottom-left","top","right","bottom","left"].includes(e)},offset:{type:Array,validator:e=>e.length===2},expand:Boolean};function Ce(){const{props:e,proxy:{$q:o}}=O(),a=P(X,j);if(a===j)return console.error("QPageSticky needs to be child of QLayout"),j;const s=c(()=>{const n=e.position;return{top:n.indexOf("top")!==-1,right:n.indexOf("right")!==-1,bottom:n.indexOf("bottom")!==-1,left:n.indexOf("left")!==-1,vertical:n==="top"||n==="bottom",horizontal:n==="left"||n==="right"}}),r=c(()=>a.header.offset),i=c(()=>a.right.offset),f=c(()=>a.footer.offset),l=c(()=>a.left.offset),u=c(()=>{let n=0,h=0;const v=s.value,$=o.lang.rtl===!0?-1:1;v.top===!0&&r.value!==0?h=`${r.value}px`:v.bottom===!0&&f.value!==0&&(h=`${-f.value}px`),v.left===!0&&l.value!==0?n=`${$*l.value}px`:v.right===!0&&i.value!==0&&(n=`${-$*i.value}px`);const g={transform:`translate(${n}, ${h})`};return e.offset&&(g.margin=`${e.offset[1]}px ${e.offset[0]}px`),v.vertical===!0?(l.value!==0&&(g[o.lang.rtl===!0?"right":"left"]=`${l.value}px`),i.value!==0&&(g[o.lang.rtl===!0?"left":"right"]=`${i.value}px`)):v.horizontal===!0&&(r.value!==0&&(g.top=`${r.value}px`),f.value!==0&&(g.bottom=`${f.value}px`)),g}),p=c(()=>`q-page-sticky row flex-center fixed-${e.position} q-page-sticky--${e.expand===!0?"expand":"shrink"}`);function b(n){const h=W(n.default);return _("div",{class:p.value,style:u.value},e.expand===!0?h:[_("div",h)])}return{$layout:a,getStickyContent:b}}const Me=A({name:"QPageSticky",props:$e,setup(e,{slots:o}){const{getStickyContent:a}=Ce();return()=>a(o)}}),qe=["src"],ze=V({__name:"WdMapStyleSwitchItem",props:{item:{}},setup(e){return(o,a)=>(M(),z(F,{style:{padding:"0"},ripple:!1,color:o.item.active?"accent-500":"primary-400"},{default:k(()=>[w(K,{size:"55px",square:""},{default:k(()=>[ee("img",{style:{padding:"3px"},src:o.item.img},null,8,qe)]),_:1})]),_:1},8,["color"]))}}),Le=R(ze,[["__file","WdMapStyleSwitchItem.vue"]]),je=V({__name:"WdMapStyleSwitcher",props:te({mapStyle:{},position:{default:"top-left"}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const o=x(!1),a=P(me);function s(){if(i.value!==void 0){for(let l=0,u=i.value.length;l<u;l++)if(i.value[l].active)return i.value[l]}}function r(l){if(i.value===void 0)return!1;const u=s();if(u!==void 0&&l.name==u.name)return!1;a.value.setStyle(l.style,{diff:!1});for(let p=0,b=i.value.length;p<b;p++)i.value[p].active=!1;return l.active=!0,o.value=!1,!0}const i=oe(e,"modelValue");return console.debug(e.mapStyle),(l,u)=>(M(),z(Me,{position:l.position,offset:[18,18],style:{"z-index":"5"}},{default:k(()=>[w(ke,{ref:"fabStyleRef",push:"","vertical-actions-align":"left",icon:"img:src/assets/wodore-design/icons/style-switch.svg",padding:"sm",direction:"right",persistent:"",color:o.value?"negative-300":"primary-100",modelValue:o.value,"onUpdate:modelValue":u[0]||(u[0]=p=>o.value=p)},{default:k(()=>[(M(!0),ae(se,null,le(i.value,(p,b)=>ne((M(),z(Le,{tabindex:b,onClick:n=>r(p),key:p.name,item:p},null,8,["tabindex","onClick","item"])),[[ie,!0]])),128))]),_:1},8,["color","modelValue"])]),_:1},8,["position"]))}}),Be=R(je,[["__file","WdMapStyleSwitcher.vue"]]),Pe=11,Ve={"text-field":["get","name"],"text-size":["interpolate",["linear"],["zoom"],7,7,9,10,22,16],"text-font":["Open Sans Semibold"],"text-anchor":"bottom","icon-allow-overlap":!0,"text-allow-overlap":!1,"symbol-sort-key":["get","type_id"],"icon-overlap":"always","text-overlap":"never","text-optional":!0,"icon-image":["step",["zoom"],["coalesce",["image",["concat","wodore:simple/",["get","type_open_slug"]]],["image","wodore:simple/unknown"]],Pe,["coalesce",["image",["concat","wodore:detailed/",["get","type_open_slug"]]],["image","wodore:detailed/unknown"]]],"icon-size":["interpolate",["linear"],["zoom"],7,.1,9,.3,20,2],visibility:"visible"},Re={"icon-opacity":["interpolate",["linear"],["zoom"],7,.7,12,.8,22,.85],"text-opacity":["step",["zoom"],0,9,1],"text-halo-width":2,"text-halo-color":"#ffffff","text-translate":["interpolate",["linear"],["zoom"],9,["literal",[0,-6]],20,["literal",[0,-40]]]};function Qe({name:e,tiles:o,attribution:a}){const s={version:8,sources:{},glyphs:"https://fonts.openmaptiles.org/{fontstack}/{range}.pbf",layers:[{id:`${e}-raster-layer`,type:"raster",source:`${e}-raster-tiles`,minzoom:0,maxzoom:22}]};return s.sources[`${e}-raster-tiles`]={type:"raster",tiles:o,tileSize:256,attribution:a},s}const Ie="/assets/outdoor-v2-BR_lxvv7.png",Ae="/assets/satellite-C2H1DPJ2.png",Oe="/assets/select_map-BPM0HDk0.png",Fe="/assets/swiss-raster-D1bEQQjo.png",We="/assets/swiss-vector-BQsQYbTX.png",Ee=Qe({name:"swiss-raster",tiles:["https://wmts0.geo.admin.ch/1.0.0/ch.swisstopo.pixelkarte-farbe/default/current/3857/{z}/{x}/{y}.jpeg","https://wmts1.geo.admin.ch/1.0.0/ch.swisstopo.pixelkarte-farbe/default/current/3857/{z}/{x}/{y}.jpeg","https://wmts2.geo.admin.ch/1.0.0/ch.swisstopo.pixelkarte-farbe/default/current/3857/{z}/{x}/{y}.jpeg","https://wmts3.geo.admin.ch/1.0.0/ch.swisstopo.pixelkarte-farbe/default/current/3857/{z}/{x}/{y}.jpeg","https://wmts4.geo.admin.ch/1.0.0/ch.swisstopo.pixelkarte-farbe/default/current/3857/{z}/{x}/{y}.jpeg","https://wmts5.geo.admin.ch/1.0.0/ch.swisstopo.pixelkarte-farbe/default/current/3857/{z}/{x}/{y}.jpeg","https://wmts6.geo.admin.ch/1.0.0/ch.swisstopo.pixelkarte-farbe/default/current/3857/{z}/{x}/{y}.jpeg","https://wmts7.geo.admin.ch/1.0.0/ch.swisstopo.pixelkarte-farbe/default/current/3857/{z}/{x}/{y}.jpeg","https://wmts8.geo.admin.ch/1.0.0/ch.swisstopo.pixelkarte-farbe/default/current/3857/{z}/{x}/{y}.jpeg","https://wmts9.geo.admin.ch/1.0.0/ch.swisstopo.pixelkarte-farbe/default/current/3857/{z}/{x}/{y}.jpeg"],attribution:'<a href="https://www.swisstopo.admin.ch/" target="_blank">&copy; swisstop</a>'});function q(e){return new URL(Object.assign({"/src/assets/wodore-design/map/switch/outdoor-v2.png":Ie,"/src/assets/wodore-design/map/switch/satellite.png":Ae,"/src/assets/wodore-design/map/switch/select_map.png":Oe,"/src/assets/wodore-design/map/switch/swiss-raster.png":Fe,"/src/assets/wodore-design/map/switch/swiss-vector.png":We})[`/src/assets/wodore-design/map/switch/${e}`],import.meta.url).href}const Te=re("map-styles",()=>({styles:[{name:"swiss-vector",label:"Topo Vector",active:!0,img:q("swiss-vector.png"),style:"https://api.maptiler.com/maps/ch-swisstopo-lbm-vivid/style.json?key=yYYuZy3hwmMjY087FDvY"},{name:"swiss-raster",label:"Topo Raster",img:q("swiss-raster.png"),style:Ee},{name:"satellite",label:"Satellite",img:q("satellite.png"),style:"https://api.maptiler.com/maps/hybrid/style.json?key=cQX2iET1gmOW38bedbUh"},{name:"outdoor-osm",label:"Outdoor OSM",img:q("outdoor-v2.png"),style:"https://api.maptiler.com/maps/outdoor-v2/style.json?key=yYYuZy3hwmMjY087FDvY"}]})),B=8,Ye=7.5,Ze=V({__name:"WdMapView",setup(e){ce(t=>({"1c3f564c":i.value,"4a267d22":u.value,"49fe9c86":l.value,"0a00ef3e":f.value}));const o=ue(),a=pe(),s=Te(),r=P("_q_l_"),i=x("0"),f=x("0"),l=x("0"),u=x("0");r===void 0?console.error("MapView needs to be child of QLayout"):de(()=>{i.value=`${r.header.offset}px`,f.value=`${r.right.offset}px`,r.footer.offset<window.innerHeight-250&&(l.value=`${r.footer.offset}px`),u.value=`${r.left.offset}px`,console.debug("Layout offsets changed: (top, right, bottom, left): ",i.value,f.value,l.value,u.value)});const p=x("https://api.wodore.com/v1/huts/huts.geojson?lang=de&limit=5000&embed_all=false&embed_type=true&embed_owner=false&embed_capacity=false&embed_sources=false&include_elevation=false&include_name=true&flat=true");function b(t){console.debug(`Maplibre version ${t.map.version} loaded`),t.map.scrollZoom.setWheelZoomRate(.003),C(t)}function n(t){if(console.debug("Hut layer clicked."),t.target.getZoom()>B){let y=t.features?.[0];if(console.debug("  Selected huts:",t.features?.map(m=>m.properties.slug)),y){const m=y.properties.slug;a.params.slug==m?o.push({name:"map",hash:a.hash,query:a.query}):o.push({name:"map-hut",params:{slug:m},hash:a.hash,query:a.query})}}}function h(t){t.target.getZoom()>B&&(t.target.getCanvas().style.cursor="pointer")}function v(t){t.target.getZoom()>B&&(t.target.getCanvas().style.cursor="")}const g="https://api.wodore.com"+"/static/huts/sprite";function C(t){console.debug("Style data changed");const y=t.map.getSprite();let m=!1;for(const S of y)S.id=="wodore"&&(m=!0);m||(console.debug(`Add sprite 'wodore' from '${g}'`),t.map.addSprite("wodore",g))}const L=[8.22,46.7];return(t,y)=>{const m=Be,S=Q("MglGeolocationControl"),E=Q("MglGeoJsonSource");return M(),z(d(be),{language:"de","onMap:styledata":C,"onMap:load":b,hash:"p",zoom:Ye,center:L,"map-style":d(s).styles[0].style,style:{position:"fixed",right:"0px",top:"0",bottom:"0",left:"0"}},{default:k(()=>[w(m,{modelValue:d(s).styles,"onUpdate:modelValue":y[0]||(y[0]=T=>d(s).styles=T),"map-style":d(s).styles[0]},null,8,["modelValue","map-style"]),w(S),w(d(ge)),w(d(he)),w(d(ve),{"map-styles":d(s).styles,"map-style":d(s).styles[0],position:"top-right"},null,8,["map-styles","map-style"]),w(E,{"source-id":"huts",data:p.value},{default:k(()=>[w(d(ye),{onClick:fe(n,["prevent"]),onMouseenter:h,onMouseleave:v,layout:d(Ve),paint:d(Re),"layer-id":"huts"},null,8,["layout","paint"])]),_:1},8,["data"])]),_:1},8,["map-style"])}}}),Ge=R(Ze,[["__file","WdMapView.vue"]]);export{Ge as default};
