import{y as k,b0 as L,M as j,R as Z,i as z,r as i,S as Y,B as _,C as $,E,F as v,H as s,I as t,b1 as R,_ as V}from"./index-BgdWgtZV.js";import{_ as q,j as F,F as H,c as W,C as B}from"./vue-maplibre-gl.es-DnM2kg8z.js";import"./_commonjsHelpers-C4iS2aBk.js";const G=11,O={"text-field":["get","name"],"text-size":["interpolate",["linear"],["zoom"],7,7,9,10,22,16],"text-font":["Open Sans Semibold"],"text-anchor":"bottom","icon-allow-overlap":!0,"text-allow-overlap":!1,"symbol-sort-key":["get","type_id"],"icon-overlap":"always","text-overlap":"never","text-optional":!0,"icon-image":["step",["zoom"],["coalesce",["image",["concat","wodore:simple/",["get","type_open_slug"]]],["image","wodore:simple/unknown"]],G,["coalesce",["image",["concat","wodore:detailed/",["get","type_open_slug"]]],["image","wodore:detailed/unknown"]]],"icon-size":["interpolate",["linear"],["zoom"],7,.1,9,.3,20,2],visibility:"visible"},A={"icon-opacity":["interpolate",["linear"],["zoom"],7,.7,12,.8,22,.85],"text-opacity":["step",["zoom"],0,9,1],"text-halo-width":2,"text-halo-color":"#ffffff","text-translate":["interpolate",["linear"],["zoom"],9,["literal",[0,-6]],20,["literal",[0,-40]]]},d=[{name:"swiss-vector",label:"Swisstopo",style:"https://api.maptiler.com/maps/ch-swisstopo-lbm-vivid/style.json?key=yYYuZy3hwmMjY087FDvY"},{name:"satellite",label:"Satellite",style:"https://api.maptiler.com/maps/hybrid/style.json?key=cQX2iET1gmOW38bedbUh"},{name:"outdoor-osm",label:"Outdoor OSM",style:"https://api.maptiler.com/maps/outdoor-v2/style.json?key=yYYuZy3hwmMjY087FDvY"}],f=8,U="https://api.wodore.com",D=7.5,I=k({__name:"WdMapView",setup(J){L(e=>({44638410:r.value,"480934ac":u.value,"5a119990":c.value,"8d187bd2":p.value}));const y=j(),l=Z(),a=z("_q_l_"),r=i("0"),p=i("0"),c=i("0"),u=i("0");a===void 0?console.error("MapView needs to be child of QLayout"):Y(()=>{r.value=`${a.header.offset}px`,p.value=`${a.right.offset}px`,a.footer.offset<window.innerHeight-250&&(c.value=`${a.footer.offset}px`),u.value=`${a.left.offset}px`,console.debug("Layout offsets changed: (top, right, bottom, left): ",r.value,p.value,c.value,u.value)});const w=i("https://api.wodore.com/v1/huts/huts.geojson?lang=de&limit=5000&embed_all=false&embed_type=true&embed_owner=false&embed_capacity=false&embed_sources=false&include_elevation=false&include_name=true&flat=true");function b(e){console.debug(`Maplibre version ${e.map.version} loaded`),e.map.scrollZoom.setWheelZoomRate(.003),g(e)}function x(e){if(console.debug("Hut layer clicked."),e.target.getZoom()>f){let n=e.features?.[0];if(console.debug("  Selected huts:",e.features?.map(o=>o.properties.slug)),n){const o=n.properties.slug;l.params.slug==o?y.push({name:"map",hash:l.hash,query:l.query}):y.push({name:"map-hut",params:{slug:o},hash:l.hash,query:l.query})}}}function M(e){e.target.getZoom()>f&&(e.target.getCanvas().style.cursor="pointer")}function S(e){e.target.getZoom()>f&&(e.target.getCanvas().style.cursor="")}const h=U+"/static/huts/sprite";function g(e){console.debug("Style data changed");const n=e.map.getSprite();let o=!1;for(const m of n)m.id=="wodore"&&(o=!0);o||(console.debug(`Add sprite 'wodore' from '${h}'`),e.map.addSprite("wodore",h))}const C=[8.22,46.7];return(e,n)=>{const o=_("MglGeolocationControl"),m=_("MglGeoJsonSource");return $(),E(t(B),{language:"de","onMap:styledata":g,"onMap:load":b,hash:"p",zoom:D,center:C,"map-style":t(d)[0].style,style:{position:"fixed",right:"0px",top:"0",bottom:"0",left:"0"}},{default:v(()=>[s(o),s(t(q)),s(t(F)),s(t(H),{"map-styles":t(d),"map-style":t(d)[0],position:"top-left"},null,8,["map-styles","map-style"]),s(m,{"source-id":"huts",data:w.value},{default:v(()=>[s(t(W),{onClick:R(x,["prevent"]),onMouseenter:M,onMouseleave:S,layout:t(O),paint:t(A),"layer-id":"huts"},null,8,["layout","paint"])]),_:1},8,["data"])]),_:1},8,["map-style"])}}}),N=V(I,[["__file","WdMapView.vue"]]);export{N as default};
