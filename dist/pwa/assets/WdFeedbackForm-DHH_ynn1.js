import{g as N,b as R,Q as P,a as $}from"./imageService-hQO1WUHg.js";import{c as j,g as A,r as E,aT as D,aY as L,aZ as M,o as O,s as T,v as W,a_ as z,am as B,n as K,aN as G,a$ as H,z as J,N as Y,ar as Z,D as k,F as w,G as u,b0 as X,I as t,J as ee,b1 as te,H as V,a5 as C,a4 as x,E as ae,aq as oe,M as ne,Q as S,K as se,ah as le,b2 as re,au as ie,av as ue,_ as ce}from"./index-D1cpBYhg.js";import{u as de,c as me}from"./index-B1mbiyUi.js";import"./QScrollObserver-a9jksypm.js";import"./use-hydration-Cjcx8aCk.js";import"./_commonjsHelpers-C4iS2aBk.js";const fe=j({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validationSuccess","validationError"],setup(l,{slots:v,emit:h}){const n=A(),s=E(null);let p=0;const d=[];function g(e){const c=typeof e=="boolean"?e:l.noErrorFocus!==!0,m=++p,F=(o,i)=>{h(`validation${o===!0?"Success":"Error"}`,i)},Q=o=>{const i=o.validate();return typeof i.then=="function"?i.then(f=>({valid:f,comp:o}),f=>({valid:!1,comp:o,err:f})):Promise.resolve({valid:i,comp:o})};return(l.greedy===!0?Promise.all(d.map(Q)).then(o=>o.filter(i=>i.valid!==!0)):d.reduce((o,i)=>o.then(()=>Q(i).then(f=>{if(f.valid===!1)return Promise.reject(f)})),Promise.resolve()).catch(o=>[o])).then(o=>{if(o===void 0||o.length===0)return m===p&&F(!0),!0;if(m===p){const{comp:i,err:f}=o[0];if(f!==void 0&&console.error(f),F(!1,i),c===!0){const I=o.find(({comp:q})=>typeof q.focus=="function"&&z(q.$)===!1);I!==void 0&&I.comp.focus()}}return!1})}function y(){p++,d.forEach(e=>{typeof e.resetValidation=="function"&&e.resetValidation()})}function _(e){e!==void 0&&B(e);const c=p+1;g().then(m=>{c===p&&m===!0&&(l.onSubmit!==void 0?h("submit",e):e!==void 0&&e.target!==void 0&&typeof e.target.submit=="function"&&e.target.submit())})}function b(e){e!==void 0&&B(e),h("reset"),K(()=>{y(),l.autofocus===!0&&l.noResetFocus!==!0&&r()})}function r(){G(()=>{if(s.value===null)return;const e=s.value.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||s.value.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||s.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(s.value.querySelectorAll("[tabindex]"),c=>c.tabIndex!==-1);e?.focus({preventScroll:!0})})}D(H,{bindComponent(e){d.push(e)},unbindComponent(e){const c=d.indexOf(e);c!==-1&&d.splice(c,1)}});let a=!1;return L(()=>{a=!0}),M(()=>{a===!0&&l.autofocus===!0&&r()}),O(()=>{l.autofocus===!0&&r()}),Object.assign(n.proxy,{validate:g,resetValidation:y,submit:_,reset:b,focus:r,getValidationComponents:()=>d}),()=>T("form",{class:"q-form",ref:s,onSubmit:_,onReset:b},W(v.default))}}),U=l=>(ie("data-v-a1bfd422"),l=l(),ue(),l),pe=U(()=>V("div",{class:"card-header absolute-bottom text-white text-h5"},null,-1)),he=U(()=>V("div",{class:"absolute-bottom text-accent-400 text-h4 text-center card-header__text"}," Feedback ",-1)),ve={class:"col no-wrap items-center q-py-md"},ge={class:"q-gutter-md q-pt-md"},be="https://cdn.pixabay.com/photo/2014/05/11/11/12/mailbox-341744_1280.jpg",xe=J({__name:"WdFeedbackForm",setup(l){const v=de(),h=Y(),n=Z({email:"",subject:"",message:"",urls:[]}),s=E([]);function p(){console.debug(`Submitted form for '${n.email}'`,n.message),n.urls=s.value.map(r=>r.value),me.POST("/v1/feedback/",{body:n}).then(()=>{v.notify({color:"positive",textColor:"black",icon:"wd-checkmark",message:"Nachricht gesendet"}),h.go(-1),setTimeout(()=>{g()},200)}).catch(()=>{v.notify({color:"negative",textColor:"black",icon:"wd-close",message:"Nachricht konnte nicht gesendet werden"})})}function d(){n.email||n.message?v.dialog({dark:!0,title:"Confirm",message:"Do you want to close it and dismiss the data?",cancel:!0,persistent:!0}).onOk(()=>{h.go(-1)}):h.go(-1)}function g(){n.email="",n.message=""}function y(){const r=s.value.length,a=r>0?s.value[r-1].id+1:0;console.log(s.value),console.log(a),s.value.push({value:"",id:a,placeholder:`URL ${a+1}`})}function _(r){s.value.splice(r,1)}const b=N(be,{focal:"0.5,0.45",size:"800x300",quality:50});return console.log(b),(r,a)=>(k(),w(X,{class:"card",style:{"min-width":"400px",width:"500px","max-width":"700px"}},{default:u(()=>[t(fe,{onSubmit:p,onReset:g,class:"fit"},{default:u(()=>[t(R,{src:ee(b)},{default:u(()=>[pe,he]),_:1},8,["src"]),t(te,{style:{padding:"0"}},{default:u(()=>[t(P,{style:{"min-height":"200px",height:"450px","max-height":"600px",padding:"0 20px 0 20px"}},{default:u(()=>[V("div",ve,[V("div",ge,[t(C,{modelValue:n.subject,"onUpdate:modelValue":a[0]||(a[0]=e=>n.subject=e),dense:"","aria-label":"Betreff",outlined:"",counter:"",placeholder:"Betreff",maxlength:"60"},{prepend:u(()=>[t(x,{name:"wd-subject"})]),_:1},8,["modelValue"]),t(C,{dense:"",modelValue:n.email,"onUpdate:modelValue":a[1]||(a[1]=e=>n.email=e),outlined:"","aria-label":"E-Mail",placeholder:"name@domain.com",type:"email",maxlength:"100",rules:[e=>!!e||"E-Mail fehlt"]},{prepend:u(()=>[t(x,{name:"wd-at"})]),_:1},8,["modelValue","rules"]),t(C,{modelValue:n.message,"onUpdate:modelValue":a[2]||(a[2]=e=>n.message=e),autogrow:"",counter:"","aria-label":"Nachricht",placeholder:"Nachricht",dense:"",outlined:"",type:"textarea",maxlength:"10000",rules:[e=>!!e||"Nachricht fehlt"]},{prepend:u(()=>[t(x,{name:"wd-text-outline"})]),_:1},8,["modelValue","rules"]),(k(!0),ae(ne,null,oe(s.value,(e,c)=>(k(),w(C,{key:e.id,modelValue:e.value,"onUpdate:modelValue":m=>e.value=m,dense:"",outlined:"",maxlength:"300",placeholder:e.placeholder,rules:[m=>!!m||"URL fehlt"]},{prepend:u(()=>[t(x,{name:"wd-link"})]),append:u(()=>[t(x,{name:"wd-close",onClick:m=>_(c),class:"cursor-pointer"},null,8,["onClick"])]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","rules"]))),128)),s.value.length<4?(k(),w(S,{key:0,onClick:a[3]||(a[3]=e=>y()),class:"text-grey-8",label:"URL",flat:"",icon:"wd-add-outline"})):se("",!0)])])]),_:1})]),_:1}),t(le),t(re,null,{default:u(()=>[t(S,{label:"Close",color:"secondary-700",flat:"",onClick:a[4]||(a[4]=e=>d()),class:"q-ml-sm"}),t(S,{label:"Reset",type:"reset",color:"secondary-700",flat:"",class:"q-ml-sm"}),t($),t(S,{label:"Submit",flat:"",type:"submit",color:"accent"})]),_:1})]),_:1})]),_:1}))}}),Fe=ce(xe,[["__scopeId","data-v-a1bfd422"],["__file","WdFeedbackForm.vue"]]);export{Fe as default};
