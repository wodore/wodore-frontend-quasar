import{g as N,b as P,Q as $,a as j}from"./imageService-Bluiepv3.js";import{h as A,l as z,r as U,aV as L,aY as M,aZ as O,y as W,C as D,E as T,a_ as K,am as E,z as Z,aR as J,a$ as Y,d as G,u as H,ar as X,o as S,K as w,L as c,a7 as ee,N as F,b0 as te,e as t,b1 as ae,g as y,a6 as C,Q as x,c as oe,aq as se,R as ne,M as V,O as le,b2 as re,b3 as ie,ay as ce,az as ue,_ as de}from"./index-CKjq3DZI.js";import{u as me,c as fe}from"./index-CZq7IISs.js";import"./QScrollObserver-DqdkwzOv.js";import"./use-hydration-BdXFThQl.js";import"./_commonjsHelpers-C4iS2aBk.js";const pe=A({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validationSuccess","validationError"],setup(l,{slots:h,emit:g}){const s=z(),n=U(null);let p=0;const d=[];function v(e){const u=typeof e=="boolean"?e:l.noErrorFocus!==!0,m=++p,q=(o,i)=>{g(`validation${o===!0?"Success":"Error"}`,i)},I=o=>{const i=o.validate();return typeof i.then=="function"?i.then(f=>({valid:f,comp:o}),f=>({valid:!1,comp:o,err:f})):Promise.resolve({valid:i,comp:o})};return(l.greedy===!0?Promise.all(d.map(I)).then(o=>o.filter(i=>i.valid!==!0)):d.reduce((o,i)=>o.then(()=>I(i).then(f=>{if(f.valid===!1)return Promise.reject(f)})),Promise.resolve()).catch(o=>[o])).then(o=>{if(o===void 0||o.length===0)return m===p&&q(!0),!0;if(m===p){const{comp:i,err:f}=o[0];if(f!==void 0&&console.error(f),q(!1,i),u===!0){const R=o.find(({comp:B})=>typeof B.focus=="function"&&K(B.$)===!1);R!==void 0&&R.comp.focus()}}return!1})}function _(){p++,d.forEach(e=>{typeof e.resetValidation=="function"&&e.resetValidation()})}function k(e){e!==void 0&&E(e);const u=p+1;v().then(m=>{u===p&&m===!0&&(l.onSubmit!==void 0?g("submit",e):e!==void 0&&e.target!==void 0&&typeof e.target.submit=="function"&&e.target.submit())})}function b(e){e!==void 0&&E(e),g("reset"),Z(()=>{_(),l.autofocus===!0&&l.noResetFocus!==!0&&r()})}function r(){J(()=>{if(n.value===null)return;const e=n.value.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||n.value.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||n.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(n.value.querySelectorAll("[tabindex]"),u=>u.tabIndex!==-1);e?.focus({preventScroll:!0})})}L(Y,{bindComponent(e){d.push(e)},unbindComponent(e){const u=d.indexOf(e);u!==-1&&d.splice(u,1)}});let a=!1;return M(()=>{a=!0}),O(()=>{a===!0&&l.autofocus===!0&&r()}),W(()=>{l.autofocus===!0&&r()}),Object.assign(s.proxy,{validate:v,resetValidation:_,submit:k,reset:b,focus:r,getValidationComponents:()=>d}),()=>D("form",{class:"q-form",ref:n,onSubmit:k,onReset:b},T(h.default))}}),Q=l=>(ce("data-v-0896c718"),l=l(),ue(),l),he=Q(()=>y("div",{class:"card-header absolute-bottom text-white text-h5"},null,-1)),ge=Q(()=>y("div",{class:"absolute-bottom text-accent-400 text-h4 text-center card-header__text"}," Mitteilung ",-1)),ve={class:"col no-wrap items-center q-py-md"},be=Q(()=>y("p",{class:"text-body1 q-pt-md"}," Sag uns, was du denkst! Jede Rückmeldung, egal ob positiv oder negativ, hilft uns weiter. ",-1)),xe={class:"q-gutter-md q-pt-md"},ye="https://cdn.pixabay.com/photo/2014/05/11/11/12/mailbox-341744_1280.jpg",_e=G({__name:"WdFeedbackForm",setup(l){const h=me(),g=H(),s=X({email:"",subject:"",message:"",urls:[]}),n=U([]);function p(){console.debug(`Submitted form for '${s.email}'`,s.message),s.urls=n.value.map(r=>r.value),fe.POST("/v1/feedback/",{body:s}).then(()=>{h.notify({color:"positive",textColor:"black",icon:"wd-checkmark",message:"Nachricht gesendet"}),g.go(-1),setTimeout(()=>{v()},200)}).catch(()=>{h.notify({color:"negative",textColor:"black",icon:"wd-close",message:"Nachricht konnte nicht gesendet werden"})})}function d(){s.email||s.message?h.dialog({dark:!0,title:"Confirm",message:"Do you want to close it and dismiss the data?",cancel:!0,persistent:!0}).onOk(()=>{g.go(-1)}):g.go(-1)}function v(){s.email="",s.message=""}function _(){const r=n.value.length,a=r>0?n.value[r-1].id+1:0;console.log(n.value),console.log(a),n.value.push({value:"",id:a,placeholder:`URL ${a+1}`})}function k(r){n.value.splice(r,1)}const b=N(ye,{focal:"0.5,0.45",size:"800x300",quality:50});return console.log(b),(r,a)=>(S(),w(te,{class:ee({"card--desktop":F(h).screen.gt.xs,"card--mobile":F(h).screen.xs})},{default:c(()=>[t(pe,{onSubmit:p,onReset:v,class:"fit"},{default:c(()=>[t(P,{src:F(b),style:{height:"140px"}},{default:c(()=>[he,ge]),_:1},8,["src"]),t(ae,{style:{padding:"0",height:"calc(100% - 196px)"}},{default:c(()=>[t($,{class:"fit",style:{padding:"0 16px 0 16px"},"thumb-style":{width:"6px",borderRadius:"8px 0 0 8px"}},{default:c(()=>[y("div",ve,[be,y("div",xe,[t(C,{modelValue:s.subject,"onUpdate:modelValue":a[0]||(a[0]=e=>s.subject=e),dense:"","aria-label":"Betreff",outlined:"",counter:"",placeholder:"Betreff",maxlength:"60"},{prepend:c(()=>[t(x,{name:"wd-subject"})]),_:1},8,["modelValue"]),t(C,{dense:"",modelValue:s.email,"onUpdate:modelValue":a[1]||(a[1]=e=>s.email=e),outlined:"","aria-label":"E-Mail",placeholder:"name@domain.com",type:"email",maxlength:"100",rules:[e=>!!e||"E-Mail fehlt"]},{prepend:c(()=>[t(x,{name:"wd-at"})]),_:1},8,["modelValue","rules"]),t(C,{modelValue:s.message,"onUpdate:modelValue":a[2]||(a[2]=e=>s.message=e),autogrow:"",counter:"","aria-label":"Nachricht",placeholder:"Nachricht",dense:"",outlined:"",type:"textarea",maxlength:"10000",rules:[e=>!!e||"Nachricht fehlt"]},{prepend:c(()=>[t(x,{name:"wd-text-outline"})]),_:1},8,["modelValue","rules"]),(S(!0),oe(ne,null,se(n.value,(e,u)=>(S(),w(C,{key:e.id,modelValue:e.value,"onUpdate:modelValue":m=>e.value=m,dense:"",outlined:"",maxlength:"300",placeholder:e.placeholder,rules:[m=>!!m||"URL fehlt"]},{prepend:c(()=>[t(x,{name:"wd-link"})]),append:c(()=>[t(x,{name:"wd-close",onClick:m=>k(u),class:"cursor-pointer"},null,8,["onClick"])]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","rules"]))),128)),n.value.length<4?(S(),w(V,{key:0,onClick:a[3]||(a[3]=e=>_()),class:"text-grey-8",label:"URL",flat:"",icon:"wd-add-outline"})):le("",!0)])])]),_:1})]),_:1}),t(re),t(ie,null,{default:c(()=>[t(V,{label:"Schliessen",color:"secondary-700",flat:"",onClick:a[4]||(a[4]=e=>d()),class:"q-ml-sm"}),t(V,{label:"Zurücksetzen",type:"reset",color:"secondary-700",flat:"",class:"q-ml-sm"}),t(j),t(V,{label:"Senden",flat:"",type:"submit",color:"accent"})]),_:1})]),_:1})]),_:1},8,["class"]))}}),qe=de(_e,[["__scopeId","data-v-0896c718"],["__file","WdFeedbackForm.vue"]]);export{qe as default};
