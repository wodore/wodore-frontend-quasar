import{bv as x}from"./index-BMytnz0s.js";import{u as D}from"./auth-store-D-XRlcA_.js";const k={"Content-Type":"application/json"},F=/\{[^{}]+\}/g;class I extends Request{constructor(t,e){super(t,e);for(const n in e)n in this||(this[n]=e[n])}}function L(r){let{baseUrl:t="",fetch:e=globalThis.fetch,querySerializer:n,bodySerializer:s,headers:o,...a}={...r};t.endsWith("/")&&(t=t.substring(0,t.length-1)),o=O(k,o);const l=[];async function f(c,i){const{fetch:b=e,headers:P,params:g={},parseAs:j="json",querySerializer:w,bodySerializer:T=s??M,...H}=i||{};let $=typeof n=="function"?n:z(n);w&&($=typeof w=="function"?w:z({...typeof n=="object"?n:{},...w}));const h={redirect:"follow",...a,...H,headers:O(o,P,g.header)};h.body&&(h.body=T(h.body)),h.body instanceof FormData&&h.headers.delete("Content-Type");let p=new I(W(c,{baseUrl:t,params:g,querySerializer:$}),h);const E={baseUrl:t,fetch:b,parseAs:j,querySerializer:$,bodySerializer:T};for(const d of l)if(d&&typeof d=="object"&&typeof d.onRequest=="function"){p.schemaPath=c,p.params=g;const y=await d.onRequest(p,E);if(y){if(!(y instanceof Request))throw new Error("Middleware must return new Request() when modifying the request");p=y}}let u=await b(p);for(let d=l.length-1;d>=0;d--){const y=l[d];if(y&&typeof y=="object"&&typeof y.onResponse=="function"){const S=await y.onResponse(u,E);if(S){if(!(S instanceof Response))throw new Error("Middleware must return new Response() when modifying the response");u=S}}}if(u.status===204||u.headers.get("Content-Length")==="0")return u.ok?{data:{},response:u}:{error:{},response:u};if(u.ok)return j==="stream"?{data:u.body,response:u}:{data:await u[j](),response:u};let A=await u.text();try{A=JSON.parse(A)}catch{}return{error:A,response:u}}return{async GET(c,i){return f(c,{...i,method:"GET"})},async PUT(c,i){return f(c,{...i,method:"PUT"})},async POST(c,i){return f(c,{...i,method:"POST"})},async DELETE(c,i){return f(c,{...i,method:"DELETE"})},async OPTIONS(c,i){return f(c,{...i,method:"OPTIONS"})},async HEAD(c,i){return f(c,{...i,method:"HEAD"})},async PATCH(c,i){return f(c,{...i,method:"PATCH"})},async TRACE(c,i){return f(c,{...i,method:"TRACE"})},use(...c){for(const i of c)if(i){if(typeof i!="object"||!("onRequest"in i||"onResponse"in i))throw new Error("Middleware must be an object with one of `onRequest()` or `onResponse()`");l.push(i)}},eject(...c){for(const i of c){const b=l.indexOf(i);b!==-1&&l.splice(b,1)}}}}function R(r,t,e){if(t==null)return"";if(typeof t=="object")throw new Error("Deeply-nested arrays/objects arenâ€™t supported. Provide your own `querySerializer()` to handle these.");return`${r}=${e?.allowReserved===!0?t:encodeURIComponent(t)}`}function q(r,t,e){if(!t||typeof t!="object")return"";const n=[],s={simple:",",label:".",matrix:";"}[e.style]||"&";if(e.style!=="deepObject"&&e.explode===!1){for(const l in t)n.push(l,e.allowReserved===!0?t[l]:encodeURIComponent(t[l]));const a=n.join(",");switch(e.style){case"form":return`${r}=${a}`;case"label":return`.${a}`;case"matrix":return`;${r}=${a}`;default:return a}}for(const a in t){const l=e.style==="deepObject"?`${r}[${a}]`:a;n.push(R(l,t[a],e))}const o=n.join(s);return e.style==="label"||e.style==="matrix"?`${s}${o}`:o}function C(r,t,e){if(!Array.isArray(t))return"";if(e.explode===!1){const o={form:",",spaceDelimited:"%20",pipeDelimited:"|"}[e.style]||",",a=(e.allowReserved===!0?t:t.map(l=>encodeURIComponent(l))).join(o);switch(e.style){case"simple":return a;case"label":return`.${a}`;case"matrix":return`;${r}=${a}`;default:return`${r}=${a}`}}const n={simple:",",label:".",matrix:";"}[e.style]||"&",s=[];for(const o of t)e.style==="simple"||e.style==="label"?s.push(e.allowReserved===!0?o:encodeURIComponent(o)):s.push(R(r,o,e));return e.style==="label"||e.style==="matrix"?`${n}${s.join(n)}`:s.join(n)}function z(r){return function(e){const n=[];if(e&&typeof e=="object")for(const s in e){const o=e[s];if(o!=null){if(Array.isArray(o)){n.push(C(s,o,{style:"form",explode:!0,...r?.array,allowReserved:r?.allowReserved||!1}));continue}if(typeof o=="object"){n.push(q(s,o,{style:"deepObject",explode:!0,...r?.object,allowReserved:r?.allowReserved||!1}));continue}n.push(R(s,o,r))}}return n.join("&")}}function v(r,t){let e=r;for(const n of r.match(F)??[]){let s=n.substring(1,n.length-1),o=!1,a="simple";if(s.endsWith("*")&&(o=!0,s=s.substring(0,s.length-1)),s.startsWith(".")?(a="label",s=s.substring(1)):s.startsWith(";")&&(a="matrix",s=s.substring(1)),!t||t[s]===void 0||t[s]===null)continue;const l=t[s];if(Array.isArray(l)){e=e.replace(n,C(s,l,{style:a,explode:o}));continue}if(typeof l=="object"){e=e.replace(n,q(s,l,{style:a,explode:o}));continue}if(a==="matrix"){e=e.replace(n,`;${R(s,l)}`);continue}e=e.replace(n,a==="label"?`.${l}`:l)}return e}function M(r){return JSON.stringify(r)}function W(r,t){let e=`${t.baseUrl}${r}`;t.params?.path&&(e=v(e,t.params.path));let n=t.querySerializer(t.params.query??{});return n.startsWith("?")&&(n=n.substring(1)),n&&(e+=`?${n}`),e}function O(...r){const t=new Headers;for(const e of r){if(!e||typeof e!="object")continue;const n=e instanceof Headers?e.entries():Object.entries(e);for(const[s,o]of n)if(o===null)t.delete(s);else if(Array.isArray(o))for(const a of o)t.append(s,a);else o!==void 0&&t.set(s,o)}return t}const N=D(),m={},_={async onRequest(r,t){return console.debug("Fetch: Request data from",r,t),m[r.url]="start",setTimeout(()=>{m[r.url]=="start"&&(m[r.url]="loading",x.start(),console.debug("  start loading bar"))},300),r},async onResponse(r,t){return console.debug("Fetch: Received data from",r,t),r.url in m&&m[r.url]=="loading"&&(x.stop(),console.debug("  stop loading bar")),m[r.url]="stopped",r}},B={async onRequest(r){const t=N.access_token;return t&&r.headers.set("Authorization",`Bearer ${t}`),r}},U=L({baseUrl:"https://api.wodore.com"});U.use(_);U.use(B);export{U as c};
