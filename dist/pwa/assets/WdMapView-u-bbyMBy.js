import{y as M,b1 as C,M as L,R as $,i as R,r as i,S as Z,B as b,C as E,E as Y,F as _,H as r,I as t,b2 as V,_ as T}from"./index-BfZ3Qqqh.js";import{_ as q,j as B,F,c as H,C as W}from"./vue-maplibre-gl.es-ZKmoijw6.js";import"./_commonjsHelpers-C4iS2aBk.js";const A=11,G={"text-field":["get","name"],"text-size":["interpolate",["linear"],["zoom"],7,7,9,10,22,16],"text-font":["Open Sans Semibold"],"text-anchor":"bottom","icon-allow-overlap":!0,"text-allow-overlap":!1,"symbol-sort-key":["get","type_id"],"icon-overlap":"always","text-overlap":"never","text-optional":!0,"icon-image":["step",["zoom"],["coalesce",["image",["concat","wodore:simple/",["get","type_open_slug"]]],["image","wodore:simple/unknown"]],A,["coalesce",["image",["concat","wodore:detailed/",["get","type_open_slug"]]],["image","wodore:detailed/unknown"]]],"icon-size":["interpolate",["linear"],["zoom"],7,.1,9,.3,20,2],visibility:"visible"},O={"icon-opacity":["interpolate",["linear"],["zoom"],7,.7,12,.8,22,.85],"text-opacity":["step",["zoom"],0,9,1],"text-halo-width":2,"text-halo-color":"#ffffff","text-translate":["interpolate",["linear"],["zoom"],9,["literal",[0,-6]],20,["literal",[0,-40]]]};function U({name:n,tiles:p,attribution:a}){const o={version:8,sources:{},glyphs:"https://fonts.openmaptiles.org/{fontstack}/{range}.pbf",layers:[{id:`${n}-raster-layer`,type:"raster",source:`${n}-raster-tiles`,minzoom:0,maxzoom:22}]};return o.sources[`${n}-raster-tiles`]={type:"raster",tiles:p,tileSize:256,attribution:a},o}const I=U({name:"swiss-raster",tiles:["https://wmts0.geo.admin.ch/1.0.0/ch.swisstopo.pixelkarte-farbe/default/current/3857/{z}/{x}/{y}.jpeg","https://wmts1.geo.admin.ch/1.0.0/ch.swisstopo.pixelkarte-farbe/default/current/3857/{z}/{x}/{y}.jpeg","https://wmts2.geo.admin.ch/1.0.0/ch.swisstopo.pixelkarte-farbe/default/current/3857/{z}/{x}/{y}.jpeg","https://wmts3.geo.admin.ch/1.0.0/ch.swisstopo.pixelkarte-farbe/default/current/3857/{z}/{x}/{y}.jpeg","https://wmts4.geo.admin.ch/1.0.0/ch.swisstopo.pixelkarte-farbe/default/current/3857/{z}/{x}/{y}.jpeg","https://wmts5.geo.admin.ch/1.0.0/ch.swisstopo.pixelkarte-farbe/default/current/3857/{z}/{x}/{y}.jpeg","https://wmts6.geo.admin.ch/1.0.0/ch.swisstopo.pixelkarte-farbe/default/current/3857/{z}/{x}/{y}.jpeg","https://wmts7.geo.admin.ch/1.0.0/ch.swisstopo.pixelkarte-farbe/default/current/3857/{z}/{x}/{y}.jpeg","https://wmts8.geo.admin.ch/1.0.0/ch.swisstopo.pixelkarte-farbe/default/current/3857/{z}/{x}/{y}.jpeg","https://wmts9.geo.admin.ch/1.0.0/ch.swisstopo.pixelkarte-farbe/default/current/3857/{z}/{x}/{y}.jpeg"],attribution:'<a href="https://www.swisstopo.admin.ch/" target="_blank">&copy; swisstop</a>'}),h=[{name:"swiss-vector",label:"Topo Vector",style:"https://api.maptiler.com/maps/ch-swisstopo-lbm-vivid/style.json?key=yYYuZy3hwmMjY087FDvY"},{name:"swiss-raster",label:"Topo Raster",style:I},{name:"satellite",label:"Satellite",style:"https://api.maptiler.com/maps/hybrid/style.json?key=cQX2iET1gmOW38bedbUh"},{name:"outdoor-osm",label:"Outdoor OSM",style:"https://api.maptiler.com/maps/outdoor-v2/style.json?key=yYYuZy3hwmMjY087FDvY"}],y=8,P=7.5,D=M({__name:"WdMapView",setup(n){C(e=>({"7d216f59":c.value,"2708b283":d.value,"7728fda7":m.value,"8b3801c0":u.value}));const p=L(),a=$(),o=R("_q_l_"),c=i("0"),u=i("0"),m=i("0"),d=i("0");o===void 0?console.error("MapView needs to be child of QLayout"):Z(()=>{c.value=`${o.header.offset}px`,u.value=`${o.right.offset}px`,o.footer.offset<window.innerHeight-250&&(m.value=`${o.footer.offset}px`),d.value=`${o.left.offset}px`,console.debug("Layout offsets changed: (top, right, bottom, left): ",c.value,u.value,m.value,d.value)});const x=i("https://api.wodore.com/v1/huts/huts.geojson?lang=de&limit=5000&embed_all=false&embed_type=true&embed_owner=false&embed_capacity=false&embed_sources=false&include_elevation=false&include_name=true&flat=true");function v(e){console.debug(`Maplibre version ${e.map.version} loaded`),e.map.scrollZoom.setWheelZoomRate(.003),w(e)}function k(e){if(console.debug("Hut layer clicked."),e.target.getZoom()>y){let l=e.features?.[0];if(console.debug("  Selected huts:",e.features?.map(s=>s.properties.slug)),l){const s=l.properties.slug;a.params.slug==s?p.push({name:"map",hash:a.hash,query:a.query}):p.push({name:"map-hut",params:{slug:s},hash:a.hash,query:a.query})}}}function z(e){e.target.getZoom()>y&&(e.target.getCanvas().style.cursor="pointer")}function S(e){e.target.getZoom()>y&&(e.target.getCanvas().style.cursor="")}const g="https://api.wodore.com"+"/static/huts/sprite";function w(e){console.debug("Style data changed");const l=e.map.getSprite();let s=!1;for(const f of l)f.id=="wodore"&&(s=!0);s||(console.debug(`Add sprite 'wodore' from '${g}'`),e.map.addSprite("wodore",g))}const j=[8.22,46.7];return(e,l)=>{const s=b("MglGeolocationControl"),f=b("MglGeoJsonSource");return E(),Y(t(W),{language:"de","onMap:styledata":w,"onMap:load":v,hash:"p",zoom:P,center:j,"map-style":t(h)[0].style,style:{position:"fixed",right:"0px",top:"0",bottom:"0",left:"0"}},{default:_(()=>[r(s),r(t(q)),r(t(B)),r(t(F),{"map-styles":t(h),"map-style":t(h)[0],position:"top-left"},null,8,["map-styles","map-style"]),r(f,{"source-id":"huts",data:x.value},{default:_(()=>[r(t(H),{onClick:V(k,["prevent"]),onMouseenter:z,onMouseleave:S,layout:t(G),paint:t(O),"layer-id":"huts"},null,8,["layout","paint"])]),_:1},8,["data"])]),_:1},8,["map-style"])}}}),K=T(D,[["__file","WdMapView.vue"]]);export{K as default};
