import{d as j,aS as L,ae as Z,an as z,i as Y,r as n,ao as $,ap as _,a9 as V,aa as q,ab as v,f as s,af as r,a8 as E}from"./index-lOTxkmD3.js";import{_ as H,j as R,F,c as G,C as O}from"./vue-maplibre-gl.es-DSESVelP.js";import"./_commonjsHelpers-C4iS2aBk.js";const f=8,A="https://api.wodore.com",B=j({__name:"MapView",setup(U){L(e=>({"3c2b5fd9":i.value,"493cd203":u.value,"465985b2":p.value,"429860c0":c.value}));const y=Z(),l=z(),o=Y("_q_l_"),i=n("0"),c=n("0"),p=n("0"),u=n("0");o===void 0?console.error("MapView needs to be child of QLayout"):$(()=>{i.value=`${o.header.offset}px`,c.value=`${o.right.offset}px`,p.value=`${o.footer.offset}px`,u.value=`${o.left.offset}px`,console.log("layout",o),o&&(console.log("layout top: ",i.value),console.log("layout right: ",c.value),console.log("layout bottom: ",p.value),console.log("layout left: ",u.value))});const b=n("https://api.wodore.com/v1/huts/huts.geojson?lang=de&limit=5000&embed_all=false&embed_type=true&embed_owner=false&embed_capacity=false&embed_sources=false&include_elevation=false&include_name=true&flat=true"),w={"text-field":["get","name"],"text-size":["interpolate",["linear"],["zoom"],7,7,9,10,22,16],"text-font":["Open Sans Semibold"],"text-anchor":"bottom","icon-allow-overlap":!0,"text-allow-overlap":!1,"symbol-sort-key":["get","type_id"],"icon-overlap":"always","text-overlap":"never","text-optional":!0,"icon-image":["step",["zoom"],["coalesce",["image",["concat","wodore:simple/",["get","type_open_slug"]]],["image","wodore:simple/unknown"]],11,["coalesce",["image",["concat","wodore:detailed/",["get","type_open_slug"]]],["image","wodore:detailed/unknown"]]],"icon-size":["interpolate",["linear"],["zoom"],7,.1,9,.3,20,2],visibility:"visible"},x={"icon-opacity":["interpolate",["linear"],["zoom"],7,.7,12,.8,22,.85],"text-opacity":["step",["zoom"],0,9,1],"text-halo-width":2,"text-halo-color":"#ffffff","text-translate":["interpolate",["linear"],["zoom"],9,["literal",[0,-6]],20,["literal",[0,-40]]]},m=[{name:"swiss-vector",label:"Swisstopo",style:"https://api.maptiler.com/maps/ch-swisstopo-lbm-vivid/style.json?key=yYYuZy3hwmMjY087FDvY"},{name:"satellite",label:"Satellite",style:"https://api.maptiler.com/maps/hybrid/style.json?key=cQX2iET1gmOW38bedbUh"},{name:"outdoor-osm",label:"Outdoor OSM",style:"https://api.maptiler.com/maps/outdoor-v2/style.json?key=yYYuZy3hwmMjY087FDvY"}];function S(e){console.debug(`Maplibre version ${e.map.version} loaded`),e.map.scrollZoom.setWheelZoomRate(.003),h(e)}function M(e){if(console.debug("Hut layer clicked:",e),e.target.getZoom()>f){let t=e.features?.[0];if(console.debug("  Selected feature:",t),t){const a=t.properties.slug;l.params.slug==a?y.push({name:"map",hash:l.hash,query:l.query}):y.push({name:"map-hut",params:{slug:a},hash:l.hash,query:l.query})}}}function C(e){console.debug("Hut layer entered:",e),e.target.getZoom()>f&&(e.target.getCanvas().style.cursor="pointer")}function k(e){console.debug("Hut layer left:",e),e.target.getZoom()>f&&(e.target.getCanvas().style.cursor="")}const g=A+"/static/huts/sprite";function h(e){console.debug("Style data changed");const t=e.map.getSprite();console.debug("Check sprite 'wodore' in ",t);let a=!1;for(const d of t)d.id=="wodore"&&(a=!0);a||(console.debug(`Add sprite 'wodore' from '${g}'`),e.map.addSprite("wodore",g))}return(e,t)=>{const a=_("MglGeolocationControl"),d=_("MglGeoJsonSource");return V(),q(r(O),{language:"de","onMap:styledata":h,"onMap:load":S,hash:"p",zoom:7.5,center:[8.22,46.7],"map-style":m[0].style,style:{position:"fixed",right:"0px",top:"0",bottom:"0",left:"0"}},{default:v(()=>[s(a),s(r(H)),s(r(R)),s(r(F),{"map-styles":m,"map-style":m[0],position:"top-left"},null,8,["map-style"]),s(d,{"source-id":"huts",data:b.value},{default:v(()=>[s(r(G),{onClick:M,onMouseenter:C,onMouseleave:k,layout:w,paint:x,"layer-id":"huts"})]),_:1},8,["data"])]),_:1},8,["map-style"])}}}),T=E(B,[["__file","MapView.vue"]]);export{T as default};
