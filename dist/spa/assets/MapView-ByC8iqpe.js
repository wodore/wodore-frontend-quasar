import{d as L,aS as j,ae as Z,aq as z,i as Y,r as n,ar as $,ak as _,a9 as q,aa as V,ab as v,f as o,af as r,a8 as E}from"./index-BInjgOLQ.js";import{_ as R,j as F,F as G,c as O,C as A}from"./vue-maplibre-gl.es-DM0FAUyJ.js";import"./_commonjsHelpers-C4iS2aBk.js";const f=8,B="https://api.wodore.com",H=L({__name:"MapView",setup(U){j(e=>({"147d2fcb":i.value,"7b250051":u.value,"35690ff5":c.value,"2c5d29dc":p.value}));const y=Z(),a=z(),s=Y("_q_l_"),i=n("0"),p=n("0"),c=n("0"),u=n("0");s===void 0?console.error("MapView needs to be child of QLayout"):$(()=>{i.value=`${s.header.offset}px`,p.value=`${s.right.offset}px`,c.value=`${s.footer.offset}px`,u.value=`${s.left.offset}px`,console.debug("Layout offsets changed: (top, right, bottom, left): ",i.value,p.value,c.value,u.value)});const b=n("https://api.wodore.com/v1/huts/huts.geojson?lang=de&limit=5000&embed_all=false&embed_type=true&embed_owner=false&embed_capacity=false&embed_sources=false&include_elevation=false&include_name=true&flat=true"),w={"text-field":["get","name"],"text-size":["interpolate",["linear"],["zoom"],7,7,9,10,22,16],"text-font":["Open Sans Semibold"],"text-anchor":"bottom","icon-allow-overlap":!0,"text-allow-overlap":!1,"symbol-sort-key":["get","type_id"],"icon-overlap":"always","text-overlap":"never","text-optional":!0,"icon-image":["step",["zoom"],["coalesce",["image",["concat","wodore:simple/",["get","type_open_slug"]]],["image","wodore:simple/unknown"]],11,["coalesce",["image",["concat","wodore:detailed/",["get","type_open_slug"]]],["image","wodore:detailed/unknown"]]],"icon-size":["interpolate",["linear"],["zoom"],7,.1,9,.3,20,2],visibility:"visible"},x={"icon-opacity":["interpolate",["linear"],["zoom"],7,.7,12,.8,22,.85],"text-opacity":["step",["zoom"],0,9,1],"text-halo-width":2,"text-halo-color":"#ffffff","text-translate":["interpolate",["linear"],["zoom"],9,["literal",[0,-6]],20,["literal",[0,-40]]]},m=[{name:"swiss-vector",label:"Swisstopo",style:"https://api.maptiler.com/maps/ch-swisstopo-lbm-vivid/style.json?key=yYYuZy3hwmMjY087FDvY"},{name:"satellite",label:"Satellite",style:"https://api.maptiler.com/maps/hybrid/style.json?key=cQX2iET1gmOW38bedbUh"},{name:"outdoor-osm",label:"Outdoor OSM",style:"https://api.maptiler.com/maps/outdoor-v2/style.json?key=yYYuZy3hwmMjY087FDvY"}];function S(e){console.debug(`Maplibre version ${e.map.version} loaded`),e.map.scrollZoom.setWheelZoomRate(.003),g(e)}function M(e){if(console.debug("Hut layer clicked."),e.target.getZoom()>f){let l=e.features?.[0];if(console.debug("  Selected huts:",e.features?.map(t=>t.properties.slug)),l){const t=l.properties.slug;a.params.slug==t?y.push({name:"map",hash:a.hash,query:a.query}):y.push({name:"map-hut",params:{slug:t},hash:a.hash,query:a.query})}}}function k(e){e.target.getZoom()>f&&(e.target.getCanvas().style.cursor="pointer")}function C(e){e.target.getZoom()>f&&(e.target.getCanvas().style.cursor="")}const h=B+"/static/huts/sprite";function g(e){console.debug("Style data changed");const l=e.map.getSprite();let t=!1;for(const d of l)d.id=="wodore"&&(t=!0);t||(console.debug(`Add sprite 'wodore' from '${h}'`),e.map.addSprite("wodore",h))}return(e,l)=>{const t=_("MglGeolocationControl"),d=_("MglGeoJsonSource");return q(),V(r(A),{language:"de","onMap:styledata":g,"onMap:load":S,hash:"p",zoom:7.5,center:[8.22,46.7],"map-style":m[0].style,style:{position:"fixed",right:"0px",top:"0",bottom:"0",left:"0"}},{default:v(()=>[o(t),o(r(R)),o(r(F)),o(r(G),{"map-styles":m,"map-style":m[0],position:"top-left"},null,8,["map-style"]),o(d,{"source-id":"huts",data:b.value},{default:v(()=>[o(r(O),{onClick:M,onMouseenter:k,onMouseleave:C,layout:w,paint:x,"layer-id":"huts"})]),_:1},8,["data"])]),_:1},8,["map-style"])}}}),T=E(H,[["__file","MapView.vue"]]);export{T as default};
