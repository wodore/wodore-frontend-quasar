import{y as Z,b0 as j,M as z,R as Y,i as $,r as n,S as E,B as _,C as R,E as V,F as v,H as a,I as i,b1 as q,_ as F}from"./index-RA_Ogsos.js";import{_ as H,j as W,F as B,c as G,C as O}from"./vue-maplibre-gl.es-DaqmZpsE.js";import"./_commonjsHelpers-C4iS2aBk.js";const f=8,A="https://api.wodore.com",U=7.5,D=Z({__name:"WdMapView",setup(I){j(e=>({c3dcd520:r.value,"241d4f4c":u.value,fcece7a0:c.value,"5fe2fb77":p.value}));const y=z(),s=Y(),o=$("_q_l_"),r=n("0"),p=n("0"),c=n("0"),u=n("0");o===void 0?console.error("MapView needs to be child of QLayout"):E(()=>{r.value=`${o.header.offset}px`,p.value=`${o.right.offset}px`,o.footer.offset<window.innerHeight-250&&(c.value=`${o.footer.offset}px`),u.value=`${o.left.offset}px`,console.debug("Layout offsets changed: (top, right, bottom, left): ",r.value,p.value,c.value,u.value)});const w=n("https://api.wodore.com/v1/huts/huts.geojson?lang=de&limit=5000&embed_all=false&embed_type=true&embed_owner=false&embed_capacity=false&embed_sources=false&include_elevation=false&include_name=true&flat=true"),b={"text-field":["get","name"],"text-size":["interpolate",["linear"],["zoom"],7,7,9,10,22,16],"text-font":["Open Sans Semibold"],"text-anchor":"bottom","icon-allow-overlap":!0,"text-allow-overlap":!1,"symbol-sort-key":["get","type_id"],"icon-overlap":"always","text-overlap":"never","text-optional":!0,"icon-image":["step",["zoom"],["coalesce",["image",["concat","wodore:simple/",["get","type_open_slug"]]],["image","wodore:simple/unknown"]],11,["coalesce",["image",["concat","wodore:detailed/",["get","type_open_slug"]]],["image","wodore:detailed/unknown"]]],"icon-size":["interpolate",["linear"],["zoom"],7,.1,9,.3,20,2],visibility:"visible"},x={"icon-opacity":["interpolate",["linear"],["zoom"],7,.7,12,.8,22,.85],"text-opacity":["step",["zoom"],0,9,1],"text-halo-width":2,"text-halo-color":"#ffffff","text-translate":["interpolate",["linear"],["zoom"],9,["literal",[0,-6]],20,["literal",[0,-40]]]},m=[{name:"swiss-vector",label:"Swisstopo",style:"https://api.maptiler.com/maps/ch-swisstopo-lbm-vivid/style.json?key=yYYuZy3hwmMjY087FDvY"},{name:"satellite",label:"Satellite",style:"https://api.maptiler.com/maps/hybrid/style.json?key=cQX2iET1gmOW38bedbUh"},{name:"outdoor-osm",label:"Outdoor OSM",style:"https://api.maptiler.com/maps/outdoor-v2/style.json?key=yYYuZy3hwmMjY087FDvY"}];function M(e){console.debug(`Maplibre version ${e.map.version} loaded`),e.map.scrollZoom.setWheelZoomRate(.003),g(e)}function S(e){if(console.debug("Hut layer clicked."),e.target.getZoom()>f){let l=e.features?.[0];if(console.debug("  Selected huts:",e.features?.map(t=>t.properties.slug)),l){const t=l.properties.slug;s.params.slug==t?y.push({name:"map",hash:s.hash,query:s.query}):y.push({name:"map-hut",params:{slug:t},hash:s.hash,query:s.query})}}}function C(e){e.target.getZoom()>f&&(e.target.getCanvas().style.cursor="pointer")}function k(e){e.target.getZoom()>f&&(e.target.getCanvas().style.cursor="")}const h=A+"/static/huts/sprite";function g(e){console.debug("Style data changed");const l=e.map.getSprite();let t=!1;for(const d of l)d.id=="wodore"&&(t=!0);t||(console.debug(`Add sprite 'wodore' from '${h}'`),e.map.addSprite("wodore",h))}const L=[8.22,46.7];return(e,l)=>{const t=_("MglGeolocationControl"),d=_("MglGeoJsonSource");return R(),V(i(O),{language:"de","onMap:styledata":g,"onMap:load":M,hash:"p",zoom:U,center:L,"map-style":m[0].style,style:{position:"fixed",right:"0px",top:"0",bottom:"0",left:"0"}},{default:v(()=>[a(t),a(i(H)),a(i(W)),a(i(B),{"map-styles":m,"map-style":m[0],position:"top-left"},null,8,["map-style"]),a(d,{"source-id":"huts",data:w.value},{default:v(()=>[a(i(G),{onClick:q(S,["prevent"]),onMouseenter:C,onMouseleave:k,layout:b,paint:x,"layer-id":"huts"})]),_:1},8,["data"])]),_:1},8,["map-style"])}}}),N=F(D,[["__file","WdMapView.vue"]]);export{N as default};
